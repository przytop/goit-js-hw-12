{"version":3,"file":"commonHelpers.js","sources":["../src/js/fetch-pixabay.js","../src/js/gallery-markup.js","../src/js/image-search.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n\nconst apiKey = '45020443-554fa7ec416e1f918b290a17c';\nconst url = `https://pixabay.com/api/`;\n\nexport async function fetchPixabay(value, page = 1) {\n  const config = {\n    params: {\n      key: apiKey,\n      q: value,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: 20,\n    },\n  };\n\n  try {\n    const response = await axios.get(url, config);\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching data from Pixabay:', error);\n    throw new Error(\n      'Unable to fetch data from Pixabay at this time. Please try again later.'\n    );\n  }\n}\n","'use strict';\n\nexport function createGalleryItemMarkup({\n  webformatURL = '',\n  largeImageURL = '',\n  tags = '',\n  likes = 0,\n  views = 0,\n  comments = 0,\n  downloads = 0,\n}) {\n  return `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n        </a>\n        <ul class=\"image-info\">\n          <li>\n            <h3 class=\"image-title\">Likes</h3>\n            <p class=\"image-stats\">${likes}</p>\n          </li>\n          <li>\n            <h3 class=\"image-title\">Views</h3>\n            <p class=\"image-stats\">${views}</p>\n          </li>\n          <li>\n            <h3 class=\"image-title\">Comments</h3>\n            <p class=\"image-stats\">${comments}</p>\n          </li>\n          <li>\n            <h3 class=\"image-title\">Downloads</h3>\n            <p class=\"image-stats\">${downloads}</p>\n          </li>\n        </ul>\n      </li>`;\n}\n","'use strict';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchPixabay } from './fetch-pixabay';\nimport { createGalleryItemMarkup } from './gallery-markup';\n\nconst form = document.querySelector('.form');\nconst loading = document.querySelector('.loading');\nconst gallery = document.querySelector('.gallery');\nconst more = document.querySelector(\"button[name='more']\");\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet page = 1;\nlet searchValue = '';\nlet totalHits = 0;\n\nfunction showToast(type, message) {\n  iziToast[type]({\n    message,\n    position: 'topRight',\n  });\n}\n\nfunction toggleElementVisibility(element, shouldShow) {\n  element.classList.toggle('disabled', !shouldShow); // Disable or enable element - must be disable on start\n}\n\nfunction handleResponse(response) {\n  if (response.hits.length === 0) {\n    showToast(\n      'warning',\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n    return;\n  }\n\n  const markup = response.hits.map(createGalleryItemMarkup).join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  page += 1;\n\n  toggleElementVisibility(more, gallery.childElementCount < totalHits);\n  lightbox.refresh();\n\n  if (gallery.childElementCount >= totalHits) {\n    toggleElementVisibility(more, false); // Hide the 'Load More' button if all results are displayed\n    showToast(\n      'info',\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n  }\n}\n\nasync function handleSearch(evt) {\n  evt.preventDefault();\n  searchValue = evt.target.search.value.trim();\n\n  if (!searchValue) {\n    showToast('error', 'Complete the field correctly');\n    return;\n  }\n\n  page = 1;\n  gallery.innerHTML = '';\n  toggleElementVisibility(loading, true);\n  toggleElementVisibility(more, false);\n\n  try {\n    const response = await fetchPixabay(searchValue, page);\n    totalHits = response.totalHits; // Set the total hits from the response\n    handleResponse(response);\n  } catch (error) {\n    showToast(\n      'error',\n      'An error occurred while fetching data. Please try again.'\n    );\n    console.error('Error fetching data:', error);\n  } finally {\n    toggleElementVisibility(loading, false);\n    form.reset();\n  }\n}\n\nasync function loadMore() {\n  toggleElementVisibility(loading, true);\n  toggleElementVisibility(more, false);\n\n  try {\n    const response = await fetchPixabay(searchValue, page);\n    handleResponse(response);\n  } catch (error) {\n    showToast(\n      'error',\n      'An error occurred while fetching data. Please try again.'\n    );\n    console.error('Error fetching data:', error);\n  } finally {\n    let rect = document.querySelector('.gallery-item').getBoundingClientRect();\n    window.scrollBy({\n      top: rect.height * 3, // Scroll down by the 3x height of the element\n      behavior: 'smooth', // Smooth scroll\n    });\n    toggleElementVisibility(loading, false);\n  }\n}\n\nform.addEventListener('submit', handleSearch);\nmore.addEventListener('click', loadMore);\n"],"names":["apiKey","url","fetchPixabay","value","page","config","axios","error","createGalleryItemMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","loading","gallery","more","lightbox","SimpleLightbox","searchValue","totalHits","showToast","type","message","iziToast","toggleElementVisibility","element","shouldShow","handleResponse","response","markup","handleSearch","evt","loadMore","rect"],"mappings":"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"}