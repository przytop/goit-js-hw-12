{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/gallery-render.js","../src/js/image-search.js"],"sourcesContent":["import axios from \"axios\";\n\nconst apiKey = \"45020443-554fa7ec416e1f918b290a17c\";\nconst url = `https://pixabay.com/api/`;\n\nexport async function fetchPixabayImages(value, page = 1) {\n  const config = {\n    params: {\n      key: apiKey,\n      q: value,\n      image_type: \"photo\",\n      orientation: \"horizontal\",\n      safesearch: true,\n      page: page,\n      per_page: 20,\n    },\n  };\n\n  try {\n    const response = await axios.get(url, config);\n    return response.data;\n  } catch (error) {\n    console.error(\"Error fetching data from Pixabay:\", error);\n    throw new Error(\n      \"Unable to fetch data from Pixabay at this time. Please try again later.\"\n    );\n  }\n}\n","export function renderGalleryItem({\n  webformatURL = \"\",\n  largeImageURL = \"\",\n  tags = \"\",\n  likes = 0,\n  views = 0,\n  comments = 0,\n  downloads = 0,\n}) {\n  const shortTags = tags.split(\",\").slice(0, 5).join(\", \"); // Limit to 5 tags\n\n  return `\n      <li class=\"gallery__item\">\n        <a class=\"gallery__link\" href=\"${largeImageURL}\">\n          <img class=\"gallery__image\" src=\"${webformatURL}\" alt=\"${shortTags}\">\n        </a>\n        <ul class=\"image__info\">\n          <li>\n            <h3 class=\"image__title\">Likes</h3>\n            <p class=\"image__stats\">${likes}</p>\n          </li>\n          <li>\n            <h3 class=\"image__title\">Views</h3>\n            <p class=\"image__stats\">${views}</p>\n          </li>\n          <li>\n            <h3 class=\"image__title\">Comments</h3>\n            <p class=\"image__stats\">${comments}</p>\n          </li>\n          <li>\n            <h3 class=\"image__title\">Downloads</h3>\n            <p class=\"image__stats\">${downloads}</p>\n          </li>\n        </ul>\n      </li>`;\n}\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { fetchPixabayImages } from \"./pixabay-api\";\nimport { renderGalleryItem } from \"./gallery-render\";\n\nlet page = 1;\nlet searchValue = \"\";\nlet totalHits = 0;\n\nconst showToast = (type, message) => {\n  iziToast[type]({\n    message,\n    position: \"bottomCenter\",\n  });\n};\n\nconst toggleElementVisibility = (element, className, shouldShow) => {\n  if (shouldShow) {\n    element.classList.remove(className);\n  } else {\n    element.classList.add(className);\n  }\n};\n\nconst updateUIAfterFetch = (galleryList, loadMore, loader) => {\n  toggleElementVisibility(loader, \"loader--hidden\", false);\n  const countOfImages = galleryList.childElementCount;\n\n  if (countOfImages >= totalHits) {\n    toggleElementVisibility(loadMore, \"load-more--hidden\", false);\n    if (page > 1) {\n      showToast(\n        \"info\",\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n  } else {\n    toggleElementVisibility(loadMore, \"load-more--hidden\", true);\n  }\n};\n\nconst handleResponse = (response, galleryList, lightbox) => {\n  if (response.hits.length === 0) {\n    showToast(\n      \"warning\",\n      \"Sorry, there are no images matching your search query. Please try again!\"\n    );\n    return;\n  }\n\n  const markup = response.hits.map(renderGalleryItem).join(\"\");\n  galleryList.insertAdjacentHTML(\"beforeend\", markup);\n  page += 1;\n  lightbox.refresh();\n};\n\nconst handleSearch = async (\n  e,\n  galleryList,\n  loadMore,\n  loader,\n  searchForm,\n  lightbox\n) => {\n  e.preventDefault();\n  searchValue = e.target.search.value.trim();\n\n  if (!searchValue) {\n    showToast(\"error\", \"Complete the field correctly\");\n    return;\n  }\n\n  page = 1;\n  galleryList.innerHTML = \"\";\n  toggleElementVisibility(loadMore, \"load-more--hidden\", false);\n  toggleElementVisibility(loader, \"loader--hidden\", true);\n\n  try {\n    const response = await fetchPixabayImages(searchValue, page);\n    totalHits = response.totalHits;\n    handleResponse(response, galleryList, lightbox);\n  } catch (error) {\n    showToast(\n      \"error\",\n      \"An error occurred while fetching data. Please try again.\"\n    );\n    console.error(\"Error fetching data:\", error);\n  } finally {\n    updateUIAfterFetch(galleryList, loadMore, loader);\n    searchForm.reset();\n  }\n};\n\nconst loadMoreImages = async (galleryList, loadMore, loader, lightbox) => {\n  toggleElementVisibility(loadMore, \"load-more--hidden\", false);\n  toggleElementVisibility(loader, \"loader--hidden\", true);\n\n  try {\n    const response = await fetchPixabayImages(searchValue, page);\n    handleResponse(response, galleryList, lightbox);\n  } catch (error) {\n    showToast(\n      \"error\",\n      \"An error occurred while fetching data. Please try again.\"\n    );\n    console.error(\"Error fetching data:\", error);\n  } finally {\n    updateUIAfterFetch(galleryList, loadMore, loader);\n    const galleryItem = document.querySelector(\".gallery__item\");\n\n    if (galleryItem) {\n      window.scrollBy({\n        top: galleryItem.getBoundingClientRect().height * 2, // Scroll down by the 2x height of the element\n        behavior: \"smooth\",\n      });\n    }\n  }\n};\n\nconst init = () => {\n  document.addEventListener(\"DOMContentLoaded\", () => {\n    const searchForm = document.querySelector(\".search__form\");\n    const galleryList = document.querySelector(\".gallery__list\");\n    const loader = document.querySelector(\".loader\");\n    const loadMore = document.querySelector(\".load-more\");\n    const loadMoreButton = document.querySelector(\".load-more__button\");\n    const lightbox = new SimpleLightbox(\".gallery a\", {\n      captionsData: \"alt\",\n      captionDelay: 250,\n    });\n\n    searchForm.addEventListener(\"submit\", (e) =>\n      handleSearch(e, galleryList, loadMore, loader, searchForm, lightbox)\n    );\n    loadMoreButton.addEventListener(\"click\", () =>\n      loadMoreImages(galleryList, loadMore, loader, lightbox)\n    );\n  });\n};\n\ninit();\n"],"names":["apiKey","url","fetchPixabayImages","value","page","config","axios","error","renderGalleryItem","webformatURL","largeImageURL","tags","likes","views","comments","downloads","shortTags","searchValue","totalHits","showToast","type","message","iziToast","toggleElementVisibility","element","className","shouldShow","updateUIAfterFetch","galleryList","loadMore","loader","handleResponse","response","lightbox","markup","handleSearch","e","searchForm","loadMoreImages","galleryItem","init","loadMoreButton","SimpleLightbox"],"mappings":"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"}