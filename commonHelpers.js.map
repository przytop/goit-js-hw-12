{"version":3,"file":"commonHelpers.js","sources":["../src/js/fetch-pixabay.js","../src/js/gallery-markup.js","../src/js/image-search.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n\nconst apiKey = '45020443-554fa7ec416e1f918b290a17c';\nconst url = `https://pixabay.com/api/`;\n\nexport async function fetchPixabay(value, page = 1) {\n  const config = {\n    params: {\n      key: apiKey,\n      q: value,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: 40,\n    },\n  };\n\n  try {\n    const response = await axios.get(url, config);\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching data from Pixabay:', error);\n    throw error; // Rethrow the error after logging it\n  }\n}\n","'use strict';\n\nexport function createGalleryItemMarkup({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n        </a>\n        <ul class=\"image-info\">\n          <li>\n            <h3 class=\"image-title\">Likes</h3>\n            <p class=\"image-stats\">${likes}</p>\n          </li>\n          <li>\n            <h3 class=\"image-title\">Views</h3>\n            <p class=\"image-stats\">${views}</p>\n          </li>\n          <li>\n            <h3 class=\"image-title\">Comments</h3>\n            <p class=\"image-stats\">${comments}</p>\n          </li>\n          <li>\n            <h3 class=\"image-title\">Downloads</h3>\n            <p class=\"image-stats\">${downloads}</p>\n          </li>\n        </ul>\n      </li>`;\n}\n","'use strict';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchPixabay } from './fetch-pixabay';\nimport { createGalleryItemMarkup } from './gallery-markup';\n\nconst form = document.querySelector('.form');\nconst loading = document.querySelector('.loader');\nconst gallery = document.querySelector('.gallery');\nconst more = document.querySelector(\"button[name='more']\");\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet page = 1;\nlet searchValue = '';\nlet totalHits = 0;\n\nfunction toggleElementVisibility(element, shouldShow) {\n  if (shouldShow) {\n    element.classList.remove('disabled');\n  } else {\n    element.classList.add('disabled');\n  }\n}\n\nfunction handleResponse(response) {\n  if (response.hits.length === 0) {\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  const markup = response.hits.map(createGalleryItemMarkup).join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  page += 1;\n\n  toggleElementVisibility(more, true);\n  lightbox.refresh();\n\n  if (gallery.childElementCount >= totalHits) {\n    toggleElementVisibility(more, false); // Hide the 'Load More' button if all results are displayed\n    iziToast.warning({\n        message: 'No more results',\n        position: 'topRight',\n    });\n  } else {\n    toggleElementVisibility(more, true); // Show the 'Load More' button if more results are available\n  }\n}\n\nasync function handleSearch(evt) {\n  evt.preventDefault();\n  searchValue = evt.target.search.value.trim();\n\n  if (searchValue === '') {\n    iziToast.warning({\n      message: 'Complete the field correctly',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  page = 1;\n  gallery.innerHTML = '';\n  toggleElementVisibility(loading, true);\n  toggleElementVisibility(more, false);\n\n  try {\n    const response = await fetchPixabay(searchValue, page);\n    totalHits = response.totalHits; // Set the total hits from the response\n    handleResponse(response);\n  } catch (error) {\n    iziToast.error({\n      message: 'An error occurred while fetching data. Please try again.',\n      position: 'topRight',\n    });\n    console.error('Error fetching data:', error);\n  } finally {\n    toggleElementVisibility(loading, false);\n    form.reset();\n  }\n}\n\nasync function loadMore() {\n  toggleElementVisibility(loading, true);\n  toggleElementVisibility(more, false);\n\n  try {\n    const response = await fetchPixabay(searchValue, page);\n    handleResponse(response);\n  } catch (error) {\n    iziToast.error({\n      message: 'An error occurred while fetching data. Please try again.',\n      position: 'topRight',\n    });\n    console.error('Error fetching data:', error);\n  } finally {\n    toggleElementVisibility(loading, false);\n  }\n}\n\nform.addEventListener('submit', handleSearch);\nmore.addEventListener('click', loadMore);\n"],"names":["apiKey","url","fetchPixabay","value","page","config","axios","error","createGalleryItemMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","loading","gallery","more","lightbox","SimpleLightbox","searchValue","totalHits","toggleElementVisibility","element","shouldShow","handleResponse","response","iziToast","markup","handleSearch","evt","loadMore"],"mappings":"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"}